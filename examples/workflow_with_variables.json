{
  "name": "API Integration with Variables",
  "description": "Workflow using variables and secrets for API integration",
  "tasks": [
    {
      "name": "fetch_user_data",
      "action_type": "http_request",
      "action_payload": {
        "url": "${var:api_base_url}/users",
        "method": "GET",
        "headers": {
          "Authorization": "Bearer ${secret:api_token}",
          "Content-Type": "application/json"
        },
        "timeout": "${var:request_timeout}"
      },
      "retry_policy": {
        "max_retries": 3,
        "initial_delay": 1.0,
        "backoff_multiplier": 2.0
      },
      "timeout_seconds": 30,
      "dependencies": []
    },
    {
      "name": "process_data",
      "action_type": "python_script",
      "action_payload": {
        "script": "process_users.py",
        "batch_size": "${var:batch_size}",
        "output_path": "${var:output_directory}"
      },
      "retry_policy": {
        "max_retries": 2,
        "initial_delay": 2.0,
        "backoff_multiplier": 2.0
      },
      "timeout_seconds": 120,
      "dependencies": ["fetch_user_data"]
    },
    {
      "name": "upload_results",
      "action_type": "http_request",
      "action_payload": {
        "url": "${var:api_base_url}/results",
        "method": "POST",
        "headers": {
          "Authorization": "Bearer ${secret:api_token}",
          "X-API-Key": "${secret:upload_key}"
        }
      },
      "retry_policy": {
        "max_retries": 5,
        "initial_delay": 1.0,
        "backoff_multiplier": 2.0
      },
      "timeout_seconds": 60,
      "dependencies": ["process_data"]
    }
  ]
}
